@model Shield.Ui.App.ViewModels.AssignedAEViewModel

<div class="card" style="padding:1.5rem 1rem 1.5rem 1rem;" >
    <h3 style="border-bottom:2px solid #eceeef; padding-bottom: 0.75rem; margin-bottom: 2.25rem;">Warning</h3>

    <p>User @Model.AssignedAE?.DisplayName (@Model.AssignedAE?.BemsId) is already assigned as AE in the LOTO @Model.LotoId.</p>

    <hr />

    <div class="text-center">
        <button type="button" onclick="onReturn()" class="btn btn-secondary-gray btn-rounded">
            <i class="fa fa-arrow-left prefix" style="margin-right:0.5rem;"></i>Return
        </button>
    </div>
</div>

function signInAE(id, bemsOrBadge, overrideTraining) {
    $('#overrideTrainingLotoModal').hide();
    closeIdentityPopupForLotoSignIn();

    let $signInLoader = $('#sign-in-loader');
    $signInLoader.css('display', 'inline');

    let overrideLoader = $('#override-sign-in-loader');
    overrideLoader.css('display', 'inline');

    $.ajax({
        url: "/Loto/AssignAE",
        type: 'POST',
        data: {
            lotoId: id,
            bemsOrBadge: bemsOrBadge,
            overrideTraining: overrideTraining
        },
        dataType: 'json',
        cache: false,
        success: function (result) {
            if (result.status === HTTP.STATUS.SUCCESS) {
                $.ajax({
                    url: "/Loto/LotoDetail?id=" + id,
                    cache: false,
                    success: function (html) {
                        $('body').html(safeResponseFilter(html)); // refresh content
                        toastr.success(safeResponseFilter(result.message), "AE Signed In", TOAST_OPTIONS_SHORT_TIMEOUT);
                    }
                });
            } else if (result.status === HTTP.STATUS.NOT_MODIFIED) {
                if (result.reason === HTTP.REASON.TRAINING) {
                    let userTrainingData = result.data.userTrainingData;
                    $.ajax({
                        url: '/Loto/GetTrainingStatus?id=' + id + '&bemsId=' + result.data.aeBemsId + '&message=' + result.message,
                        type: 'POST',
                        data: JSON.stringify(userTrainingData),
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'html',
                        success: function (response) {
                            $('#overrideTrainingLotoModal').html(response); 
                            $('#OverrideTrainingLotoConfirmation').append(safeResponseFilter('<br /><br /> Shield attempted to communicate with My Learning and was unable to provide confirmation of required training (77517 and 84757). Please document a reason for an override or cancel the sign in.'));
                            $('#overrideTrainingBemsID').val(bemsOrBadge);
                            $('#override-employee-training').show();
                            $('#OverrideTrainingSubmit').show();
                            $('#override-visitor-training').hide();
                            $('#OverrideTrainingVisitorSubmit').hide();
                            $('#OverrideTrainingPAESubmit').hide();
                            $('#overrideTrainingLotoModal').modal('show');
                        }
                    });

                } else if (result.reason === HTTP.REASON.ALREADY_EXISTS) {
                    $("#already-signed-in-message").html(safeResponseFilter(result.message));
                    $("#cannotSignIntoLotoModal").modal("show");
                } else {
                    toastr.error(result.message, "AE Not Signed In", TOAST_OPTIONS);
                }
            } else {
                if (result.reason === HTTP.REASON.TRAINING) {
                    $('#sign-in-partial').hide(200);
                    $('#sign-in-partial').html('');

                    $.ajax({
                        url: '/Loto/OverrideTrainingPartial',
                        type: 'POST',
                        data: {
                            id: result.data.lotoId,
                            bemsId: result.data.aeBemsId,
                            message: result.message,
                            aeName: result.AEName,
                            isTrainingDown: true
                        },
                        dataType: 'html',
                        async: true,
                        success: function (result) {
                            $('#sign-in-partial').html(result);
                            $('#sign-in-partial').show(200);
                        }
                    });
                } else {
                    $('#overrideTrainingLotoModal').hide();
                    toastr.error(result.message, "AE Not Signed In", TOAST_OPTIONS);
                }
            }
        },
        error: function (xhr) {
            $('#overrideTrainingLotoModal').hide();
            toastr.error("Unable to connect to LOTO service.", "Connection Error", TOAST_OPTIONS);
        },
        complete: function () {
            $signInLoader.hide();
        },
        async: true
    });
}

This is old javascript function where for Reason - Already_exists we are returning the modal to prevent an AE to sign into multiple lotos.

Now i have done several changes . I have given the above code just to remember what was there previously ok


Now i think you can remember like in previous JS function which i have pasted firstly at top , it shows cannotsignintoloto modal for showing by using result.message ok. But now we have used showAEWarningPartial function which only shows the message related to AE signing into same Loto , and that previous modal was AE signing into multiple lotos ok.

So in AEWarningPartial we should make the changes to show both the messages depending on the two cases which i told correct?

And the message should include more Properties like Program LineNumber and Site which is not there is AssignedAEViewModel, so we need to change that also by using another ViewModel that uses all the properties which are needed correct. 

TASK : We should show Warning Partial that contains both messages accordingly now by checking the conditions and all. 
Two scenarios: 1. Prevent an AE to sign into same loto.
                                2. Prevent an AE to sign into multiple loto.


<!-- Prevent an AE from signing into multiple LOTOs modal -->
<div class="modal fade" id="cannotSignIntoLotoModal" tabindex="-1" role="dialog" aria-labelledby="CannotSignIntoLoto" aria-hidden="true">
	<div class="modal-dialog modal-md" role="document">
		<div class="modal-content">
			<div class="modal-header red darken-1 white-text">
				<h4 class="select-line-modal-title">Cannot Sign-in AE</h4>
				<button type="button" class="close text-white select-close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body" id="cannotSignIntoLotoModalBody" style="padding: 0rem 3.5rem 0 3.5rem; margin-top:1.2rem">
				<div id="already-signed-in-message">
				</div>
			</div>

			<div class="modal-footer" style="margin-top:4rem;">
				<div id="signOutAction" style="float:right" class="row float-right">
					<button type="button" class="btn btn-primary btn-rounded float-right" data-dismiss="modal" aria-label="Close">
						Dismiss
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

The above div was there to render that modal in javascript ok.

And to render warning partial i have added one div. You can check below:
<div>
										<div class="tab-content" id="nav-tabContent">
											<div class="card tab-pane fade show active" id="sign-in" role="tabpanel" aria-labelledby="sign-in-tab" style="border-top-left-radius: 0;">
												<div id="sign-in-partial" class="card-body d-flex flex-column" style="margin-top:0%;">
													@Html.Partial("Partials/LotoSignInCard", new Shield.Ui.App.ViewModels.LotoAEManagementViewModel
													{
													Header = Model.Header,
													Loto = Model.Loto,
													SessionService = Model.SessionService,
													Message = Model.SignInCardMessage
													})
												</div>
											</div>
											<div id="ae-warning-partial" style="display:none;"></div>
											<div class="card tab-pane fade" id="sign-in-visitor" role="tabpanel" aria-labelledby="sign-in-visitor-tab" style="border-top-left-radius: 0;">
												<div id="visitor-sign-in-partial" class="card-body d-flex flex-column" style="margin-top:0%;">
													@Html.Partial("Partials/LotoVisitorSignInCard", new Shield.Ui.App.ViewModels.LotoAEManagementViewModel
													{
													Header = Model.Header,
													Loto = Model.Loto,
													SessionService = Model.SessionService,
													Message = Model.SignInCardMessage
													})
												</div>
											</div>
										</div>
									</div>


If you want full LotoDetail.cshtml file code which includes above html div, i can give ok. 

Now first analyze and understand carefully and provide the simple and optimize solution that works for both cases seemlessly without doing any unnecessary things ok
